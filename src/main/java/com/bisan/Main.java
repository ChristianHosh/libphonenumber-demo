package com.bisan;

import com.google.i18n.phonenumbers.NumberParseException;
import com.google.i18n.phonenumbers.PhoneNumberUtil;
import com.google.i18n.phonenumbers.Phonenumber;
import com.google.i18n.phonenumbers.geocoding.PhoneNumberOfflineGeocoder;

import java.util.ArrayList;
import java.util.List;
import java.util.Locale;
import java.util.Scanner;

public class Main {

  // numbers
  
  public static final List<String> phoneNumbers = List.of(
      "(970)059-9533317"
      , "(970)059-9835479"
      , "(970)059-9673513"
      , "(970)059-9673513"
      , "(970)059-9721934"
      , "(970)059-9229025"
      , "(970)059-9606002"
      , "(970)059-9205719"
      , "(970)059-9673510"
      , "(970)059-9673510"
      , "(972)050-5552239"
      , "(970)059-9737924"
      , "(970)059-9586878"
      , "(970)054-4282625"
      , "(970)059-9470903"
      , "(970)059-9200322"
      , "(970)059-9123344"
      , "(970)059-9586878"
      , "(970)059-9209130"
      , "(970)050-4462360"
      , "(970)059-9966669"
      , "(970)059-9845848"
      , "(970)059-9731239"
      , "(970)059-9665477"
      , "(970)059-9362908"
      , "(972)054-6838901"
      , "(972)054-6838904"
      , "(970)059-9607070"
      , "(972)052-2671117"
      , "(970)059-9226677"
      , "(970)059-9439324"
      , "(972)054-5607364"
      , "(970)059-9262264"
      , "(972)050-5213630"
      , "(970)059-9240974"
      , "(970)059-9387007"
      , "(970)059-9200322"
      , "(970)059-9068300"
      , "(970)059-9262293"
      , "(970)059-9288826"
      , "(970)059-9835789"
      , "(970)059-9620621"
      , "(970)052-2319346"
      , "(972)050-2255111"
      , "(970)050-5218536"
      , "(970)059-9750091"
      , "(970)059-9377378"
      , "(972)054-4649182"
      , "(970)059-9260011"
      , "(970)059-9207556"
      , "(970)059-9499500"
      , "(970)059-9131334"
      , "(972)054-7956623"
      , "(970)059-8896111"
      , "(970)059-9400442"
      , "(970)059-9556633"
      , "(970)059-9732314"
      , "(970)059-8106012"
      , "(970)059-9716737"
      , "(970)052-2316589"
      , "(970)057-7205418"
      , "(970)059-9420421"
      , "(970)059-9962176"
      , "(970)059-9091054"
      , "(970)054-6485169"
      , "(970)059-9679923"
      , "(970)059-9585756"
      , "(970)059-9203216"
      , "(970)059-9256309"
      , "(970)059-9636663"
      , "(970)050-5450699"
      , "(970)059-9026168"
      , "(970)059-9700862"
      , "(970)059-9787466"
      , "(970)059-9170953"
      , "(970)059-9208273"
      , "(970)054-5511049"
      , "(970)054-5511029"
      , "(970)052-2865669"
      , "(970)059-9273353"
      , "(970)059-9367229"
      , "(970)056-8560006"
      , "(970)059-9732314"
      , "(970)059-9114839"
      , "(970)059-9210018"
      , "(970)059-9263111"
      , "(970)059-9430913"
      , "(970)059-9206273"
      , "(970)059-9118869"
      , "(970)059-9312878"
      , "(970)059-9201586"
      , "(972)054-5761350"
      , "(970)059-9212166"
      , "(970)054-6541665"
      , "(970)059-9889124"
      , "(970)059-9387007"
      , "(970)054-2002724"
      , "(970)059-9943382"
      , "(970)054-5369888"
      , "(970)059-9345670"
      , "(970)059-9674567"
      , "(970)054-7514783"
      , "(970)059-9749974"
      , "(970)059-9558569"
      , "(970)059-9207205"
      , "(970)059-9362560"
      , "(970)052-3538000"
      , "(970)059-9673508"
      , "(970)054-7856359"
      , "(970)059-9296511"
      , "(970)052-8280592"
      , "(970)059-9869686"
      , "(970)059-9398297"
      , "(970)050-3211077"
      , "(970)059-5746410"
      , "(970)059-9507275"
      , "(970)059-9232925"
      , "(970)059-9200322"
      , "(970)059-9130013"
      , "(970)056-9232842"
      , "(970)059-9210666"
      , "(970)059-9841224"
      , "(970)059-9521313"
      , "(970)059-5663667"
      , "(970)054-2082918"
      , "(970)054-5567863"
      , "(970)059-9206307"
      , "(970)059-9673511"
      , "(970)059-9378278"
      , "(970)059-9378278"
      , "(970)059-9721771"
      , "(970)059-9613399"
      , "(970)059-9800288"
      , "(970)059-9240974"
      , "(970)059-9269113"
      , "(970)059-8876863"
      , "(970)054-8164041"
      , "(970)052-5475030"
      , "(970)059-9203301"
      , "(970)059-9787886"
      , "(970)059-9641120"
      , "(970)059-9275970"
      , "(970)059-9301860"
      , "(970)059-9453255"
      , "(970)059-9362638"
      , "(970)052-6140085"
      , "(970)054-5219930"
      , "(970)059-9219504"
      , "(970)059-9219504"
      , "(970)059-9258200"
      , "(970)059-9711474"
      , "(970)059-9711474"
      , "(970)054-6432263"
      , "(970)059-9272642"
      , "(970)052-2389837"
      , "(970)059-9835834"
      , "(970)059-9758895"
      , "(970)054-7713875"
      , "(970)059-9836172"
      , "(970)059-9269077"
      , "(970)059-9000464"
      , "(970)059-9452053"
      , "(970)059-9000464"
      , "(972)057-7256102"
      , "(970)059-9252070"
      , "(970)059-9252070"
      , "(970)059-9254830"
      , "(970)059-9538538"
      , "(970)059-9657694"
      , "(970)059-9362908"
      , "(970)059-9319225"
      , "(970)059-9206444"
      , "(970)059-9201211"
      , "(972)052-2305073"
      , "(970)059-9998161"
      , "(970)059-9998161"
      , "(970)059-9757461"
      , "(970)059-9440022"
      , "(972)054-4473456"
      , "(249)091-2147931"
      , "(970)054-3088184"
      , "(970)059-9206273"
      , "(970)059-9229898"
      , "(970)059-8168797"
      , "(970)059-8168797"
      , "(970)059-9677103"
      , "(970)059-9111130"
      , "(970)059-9256526"
      , "(970)059-9040001"
      , "(970)059-9730884"
      , "(970)059-9082033"
      , "(970)059-9253200"
      , "(970)054-7770393"
      , "(970)059-9599500"
      , "(970)059-9102656"
      , "(970)059-9271629"
      , "(970)059-9730717"
      , "(970)059-9040001"
      , "(972)054-4668335"
      , "(970)059-9590596"
      , "(970)059-9111150"
      , "(970)059-9677103"
      , "(972)054-9706430"
      , "(970)059-9391343"
      , "(970)059-9251737"
      , "(970)059-9582900"
      , "(970)059-9601701"
      , "(970)059-9678000"
      , "(970)059-9256648"
      , "(970)059-9210324"
      , "(970)059-9460387"
      , "(970)059-9234335"
      , "(972)052-2789513"
      , "(970)059-9234335"
      , "(970)052-2781928"
      , "(970)059-9221722"
      , "(970)059-9302021"
      , "(970)059-9114112"
      , "(970)059-9202471"
      , "(970)059-9207205"
      , "(970)059-9212166"
      , "(970)059-9223887"
      , "(970)059-9558009"
      , "(970)059-9438947"
      , "(970)059-9219249"
      , "(970)059-9269077"
      , "(970)059-9456928"
      , "(970)054-5369888"
      , "(970)059-9318346"
      , "(970)059-9721781"
      , "(970)059-8750750"
      , "(970)059-9524135"
      , "(970)059-9551867"
      , "(970)059-9760070"
      , "(970)054-4692026"
      , "(970)052-2772358"
      , "(970)059-9418057"
      , "(970)059-9396202"
      , "(970)059-9396202"
      , "(970)059-9209130"
      , "(970)059-9857771"
      , "(970)059-8168797"
      , "(972)052-3043000"
      , "(972)057-3873448"
      , "(970)059-9333111"
      , "(970)059-9502050"
      , "(970)059-9679260"
      , "(970)059-9672794"
      , "(970)059-9672794"
      , "(972)052-2732099"
      , "(970)059-9205389"
      , "(970)059-9341569"
      , "(970)059-9868875"
      , "(970)059-9682544"
      , "(970)059-9282245"
      , "(970)059-9787466"
      , "(970)054-6314965"
      , "(970)059-9671003"
      , "(970)059-9671003"
      , "(970)052-2579777"
      , "(970)059-9262095"
      , "(970)059-9262293"
      , "(970)059-9248195"
      , "(970)059-9502050"
      , "(970)059-9295350"
      , "(970)059-9305684"
      , "(970)059-9202937"
      , "(970)059-9207603"
      , "(970)059-9298668"
      , "(970)059-9243583"
      , "(970)059-9369191"
      , "(970)059-9216649"
      , "(970)059-9497934"
      , "(970)050-5395558"
      , "(970)050-5377826"
      , "(970)054-4894666"
      , "(970)059-9657847"
      , "(970)059-9795668"
      , "(970)059-9202320"
      , "(970)059-9204348"
      , "(970)052-2409780"
      , "(970)059-9157777"
      , "(970)059-9111150"
      , "(970)059-9369191"
      , "(970)059-9026168"
      , "(970)059-9091054"
      , "(970)059-9839272"
      , "(970)059-9620621"
      , "(970)050-5262233"
      , "(970)059-8988048"
      , "(970)059-9203203"
      , "(970)057-7858508"
      , "(970)059-9250802"
      , "(970)050-5281197"
      , "(970)059-9659398"
      , "(970)059-9220700"
      , "(970)059-9857016"
      , "(970)059-9835834"
      , "(970)059-9292188"
      , "(970)054-4569185"
      , "(970)059-9521212"
      , "(970)059-9242141"
      , "(970)059-9082196"
      , "(970)059-9280088"
      , "(970)059-9204236"
      , "(970)059-9318989"
      , "(970)059-9869686"
      , "(970)059-9262141"
      , "(970)059-9304445"
      , "(970)059-9436741"
      , "(970)050-8721706"
      , "(970)059-9909868"
      , "(970)050-5376113"
      , "(970)052-2300673"
      , "(970)059-9263102"
      , "(970)054-8112400"
      , "(970)059-9208282"
      , "(970)052-2781928"
      , "(970)059-9777321"
      , "(970)059-9252323"
      , "(970)059-9610890"
      , "(970)059-9507275"
      , "(972)050-5538614"
      , "(972)052-2238793"
      , "(970)059-9169912"
      , "(970)059-9726726"
      , "(970)052-2253810"
      , "(970)050-5279029"
      , "(970)050-5335229"
      , "(970)059-9665665"
      , "(970)059-9444632"
      , "(970)059-9348521"
      , "(970)059-9255233"
      , "(970)059-9202096"
      , "(970)050-5232225"
      , "(970)059-9222335"
      , "(970)050-5269306"
      , "(970)059-9720851"
      , "(970)050-5269306"
      , "(970)054-7473640"
      , "(972)052-6390118"
      , "(970)059-9649097"
      , "(970)059-9380800"
      , "(970)050-5521721"
      , "(970)059-8222700"
      , "(970)059-9082012"
      , "(970)059-9131387"
      , "(970)059-9131387"
      , "(970)059-9131387"
      , "(970)059-9595088"
      , "(972)052-2906363"
      , "(970)052-2877669"
      , "(970)059-9211077"
      , "(970)059-9232919"
      , "(970)059-8998744"
      , "(970)059-9643397"
      , "(970)050-5643397"
      , "(970)059-9543397"
      , "(970)050-5643397"
      , "(970)059-9787957"
      , "(970)059-9333666"
      , "(970)059-9524135"
      , "(970)059-9524142"
      , "(970)059-9672301"
      , "(970)054-4531234"
      , "(970)059-9207910"
      , "(970)054-6663151"
      , "(970)059-9219008"
      , "(970)059-9677448"
      , "(970)056-9000591"
      , "(970)059-9293201"
      , "(970)059-9250770"
      , "(970)054-2129403"
      , "(970)059-9798767"
      , "(970)059-8318356"
      , "(970)059-9964258"
      , "(970)059-9259604"
      , "(970)059-9200322"
      , "(970)059-9297238"
      , "(970)059-9154465"
      , "(970)059-9351968"
      , "(970)059-9673512"
      , "(970)059-9673512"
      , "(970)059-9673512"
      , "(970)059-9292258"
      , "(970)050-2272525"
      , "(970)059-9800163"
      , "(970)059-9548458"
      , "(970)059-9031133"
      , "(970)052-2656069"
      , "(970)059-9116777"
      , "(970)059-9661024"
      , "(970)059-9293607"
      , "(970)059-9797112"
      , "(970)059-9675370"
      , "(970)059-9682596"
      , "(970)059-9111451"
      , "(970)059-8313342"
      , "(970)059-9711680"
      , "(970)059-9472894"
      , "(970)059-9846819"
      , "(970)054-5971786"
      , "(970)059-9287403"
      , "(970)059-9672032"
      , "(970)052-2330523"
      , "(970)059-9287403"
      , "(970)059-9232925"
      , "(970)059-9232925"
      , "(970)059-9287903"
      , "(970)059-9287903"
      , "(970)050-5270089"
      , "(970)059-9997755"
      , "(970)059-9547687"
      , "(970)059-9835834"
      , "(970)059-9989837"
      , "(970)059-9209913"
      , "(970)059-9714217"
      , "(970)059-9130013"
      , "(972)544-4444206"
      , "(970)059-9045959"
      , "(970)059-9311114"
      , "(970)054-6518043"
      , "(970)059-9582900"
      , "(970)059-9377488"
      , "(970)052-2623950"
      , "(970)059-9767951"
      , "(970)059-9356339"
      , "(970)059-9106940"
      , "(970)059-9106940"
      , "(970)059-9644446"
      , "(970)059-9434707"
      , "(970)050-7243072"
      , "(970)059-9677301"
      , "(970)054-2367356"
      , "(972)054-4444206"
      , "(970)059-9673507"
      , "(970)059-9609334"
      , "(970)050-5262233"
      , "(970)059-9252273"
      , "(970)059-9272601"
      , "(970)059-8179882"
      , "(970)059-9424929"
      , "(970)059-9988726"
      , "(970)059-9439848"
      , "(970)059-9786603"
      , "(970)050-5235411"
      , "(972)054-4433103"
      , "(970)059-9280855"
      , "(970)059-9280855"
      , "(970)059-9257414"
      , "(970)059-9320320"
      , "(970)059-9522666"
      , "(970)050-5213630"
      , "(970)059-9469069"
      , "(970)052-5683150"
      , "(970)059-9250802"
      , "(970)059-9795840"
      , "(970)056-2768250"
      , "(972)052-5963570"
      , "(970)059-8600606"
      , "(970)059-9707278"
      , "(970)059-9256526"
      , "(970)059-9256526"
      , "(970)059-9090914"
      , "(970)059-9362560"
      , "(970)059-9309862"
      , "(970)059-9740210"
      , "(970)059-9257989"
      , "(970)059-9835834"
      , "(970)059-9983666"
      , "(970)059-9265224"
      , "(970)059-9430630"
      , "(970)059-9786558"
      , "(970)059-9424929"
      , "(970)054-2043570"
      , "(970)059-9676179"
      , "(970)059-8153334"
      , "(972)054-8174035"
      , "(972)054-7251135"
      , "(970)059-9221344"
      , "(970)059-9259604"
      , "(970)059-9292900"
      , "(972)054-5235969"
      , "(970)059-9661045"
      , "(970)054-4877191"
      , "(970)059-9111422"
      , "(970)059-9533470"
      , "(970)059-9208945"
      , "(970)059-9208915"
      , "(970)059-9873380"
      , "(970)059-9786603"
      , "(970)059-8313355"
      , "(970)059-9084093"
      , "(972)054-4531234"
      , "(972)054-4531234"
      , "(970)059-9260011"
      , "(970)059-9870939"
      , "(970)059-9870939"
      , "(970)059-9658822"
  );

  public static final PhoneNumberUtil PHONE_NUMBER_UTIL = PhoneNumberUtil.getInstance();
  public static final PhoneNumberOfflineGeocoder OFFLINE_GEOCODER = PhoneNumberOfflineGeocoder.getInstance();


  public static final String CMD_EXIT = "exit";

  public static void main(String[] args) {
    work();

    int failed = 0;
    int total = 0;
    int success = 0;
    int valid = 0;
    int invalid = 0;
    List<String> failedNumbers = new ArrayList<>();
    List<String> invalidNumbers = new ArrayList<>();

    for (int i = 0; i < phoneNumbers.size(); i++) {
      String number = phoneNumbers.get(i);
      String[] asArgs = new String[]{number};
      boolean isValid;
      try {
        isValid = parse(asArgs, i);
        success++;
      } catch (Exception e) {
        e.printStackTrace(System.err);
        failedNumbers.add(number);
        failed++;
        isValid = false;
      }
      total++;
      if (isValid)
        valid++;
      else {
        invalid++;
        invalidNumbers.add(number);
      }

    }

    System.out.println("total: " + total);
    System.out.println("success: " + success);
    System.out.println("failed: " + failed);
    System.out.println("valid: " + valid);
    System.out.println("invalid: " + invalid);
    System.out.println("failed numbers: " + failedNumbers);
    System.out.println("invalid numbers: " + invalidNumbers);
  }

  private static void work() {
    String input;

    try (Scanner scanner = new Scanner(System.in)) {
      do {
        System.out.print("\n> ");
        input = scanner.nextLine();
        if (CMD_EXIT.equals(input)) {
          break;
        }

        if (input.isBlank()) {
          System.err.println("Invalid arguments: <phone number> -<optional country code>");
          continue;
        }

        String[] args = input.split(" -");
        parse(args, 0);
      } while (true);
    } catch (Exception e) {
      e.printStackTrace(System.err);
    }
  }

  public static boolean parse(String[] args, int index) throws NumberParseException {
    String number = args[0];

    System.out.println("\n [" + index + "] NUMBER: " + number);

    String countryCode = getCountryCode(number);
    String regionCode = PHONE_NUMBER_UTIL.getRegionCodeForCountryCode(Integer.parseInt(countryCode));
    System.out.println("REGION: " + regionCode);

    boolean isValid;
    try {
      Phonenumber.PhoneNumber phoneNumber = PHONE_NUMBER_UTIL.parse(number, regionCode);
      isValid = PHONE_NUMBER_UTIL.isValidNumber(phoneNumber);

      System.out.println("country code:\t\t\t\t" + phoneNumber.getCountryCode());
      System.out.println("national number:\t\t\t" + phoneNumber.getNationalNumber());
      System.out.println("extension:\t\t\t\t" + phoneNumber.getExtension());
      System.out.println("region:\t\t\t\t\t\t" + PHONE_NUMBER_UTIL.getRegionCodeForNumber(phoneNumber));
      System.out.println("is possible number:\t\t\t" + PHONE_NUMBER_UTIL.isPossibleNumber(phoneNumber));
      System.out.println("is valid number:\t\t\t" + isValid);
      System.out.println("number type:\t\t\t\t" + PHONE_NUMBER_UTIL.getNumberType(phoneNumber));
      System.out.println("region:\t\t\t\t\t\t" + OFFLINE_GEOCODER.getDescriptionForNumber(phoneNumber, Locale.ENGLISH));
      System.out.println("FORMATTING RESULTS");
      System.out.println("E164:\t\t\t\t\t\t" + PHONE_NUMBER_UTIL.format(phoneNumber, PhoneNumberUtil.PhoneNumberFormat.E164));
      System.out.println("INTERNATIONAL:\t\t\t\t" + PHONE_NUMBER_UTIL.format(phoneNumber, PhoneNumberUtil.PhoneNumberFormat.INTERNATIONAL));
      System.out.println("NATIONAL:\t\t\t\t\t" + PHONE_NUMBER_UTIL.format(phoneNumber, PhoneNumberUtil.PhoneNumberFormat.NATIONAL));
      System.out.println("RFC3966:\t\t\t\t\t" + PHONE_NUMBER_UTIL.format(phoneNumber, PhoneNumberUtil.PhoneNumberFormat.RFC3966));

    } catch (NumberParseException e) {
      System.err.println("error parsing number: " + number);
      throw e;
    }
    return isValid;
  }

  private static String getCountryCode(String number) {
    int firstIndex = number.indexOf("(");
    int lastIndex = number.indexOf(")");
    if (firstIndex == -1 || lastIndex == -1) {
      return number;
    }
    return number.substring(firstIndex + 1, lastIndex);
  }
}